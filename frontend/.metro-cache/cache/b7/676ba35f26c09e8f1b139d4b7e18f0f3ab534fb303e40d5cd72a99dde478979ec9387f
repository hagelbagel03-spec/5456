{"dependencies":[{"name":"./encodePacket.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":71,"index":71}}],"key":"l0XJith170aiQBKbDxvaf5HJzjc=","exportNames":["*"]}},{"name":"./decodePacket.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":72},"end":{"line":2,"column":49,"index":121}}],"key":"k2ePvc7PPyN9sm4h8mrZRv0s/Hg=","exportNames":["*"]}},{"name":"./commons.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":122},"end":{"line":3,"column":45,"index":167}}],"key":"glGFVKq6JnHqcEVNii1WndfU66Y=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,e,d){Object.defineProperty(e,\"__esModule\",{value:!0}),e.createPacketDecoderStream=function(t,c){i||(i=new TextDecoder);const u=[];let l=0,w=-1,b=!1;return new TransformStream({transform(P,h){for(u.push(P);;){if(0===l){if(f(u)<1)break;const t=s(u,1);b=!(128&~t[0]),w=127&t[0],l=w<126?3:126===w?1:2}else if(1===l){if(f(u)<2)break;const t=s(u,2);w=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),l=3}else if(2===l){if(f(u)<8)break;const t=s(u,8),n=new DataView(t.buffer,t.byteOffset,t.length),c=n.getUint32(0);if(c>Math.pow(2,21)-1){h.enqueue(o.ERROR_PACKET);break}w=c*Math.pow(2,32)+n.getUint32(4),l=3}else{if(f(u)<w)break;const t=s(u,w);h.enqueue((0,n.decodePacket)(b?t:i.decode(t),c)),l=0}if(0===w||w>t){h.enqueue(o.ERROR_PACKET);break}}}})},e.createPacketEncoderStream=function(){return new TransformStream({transform(n,o){(0,t.encodePacketToBinary)(n,t=>{const c=t.length;let i;if(c<126)i=new Uint8Array(1),new DataView(i.buffer).setUint8(0,c);else if(c<65536){i=new Uint8Array(3);const t=new DataView(i.buffer);t.setUint8(0,126),t.setUint16(1,c)}else{i=new Uint8Array(9);const t=new DataView(i.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(c))}n.data&&\"string\"!=typeof n.data&&(i[0]|=128),o.enqueue(i),o.enqueue(t)})}})},Object.defineProperty(e,\"decodePacket\",{enumerable:!0,get:function(){return n.decodePacket}}),e.decodePayload=void 0,Object.defineProperty(e,\"encodePacket\",{enumerable:!0,get:function(){return t.encodePacket}}),e.protocol=e.encodePayload=void 0;var t=r(d[0]),n=r(d[1]),o=r(d[2]);const c=String.fromCharCode(30);e.encodePayload=(n,o)=>{const i=n.length,f=new Array(i);let s=0;n.forEach((n,u)=>{(0,t.encodePacket)(n,!1,t=>{f[u]=t,++s===i&&o(f.join(c))})})};let i;function f(t){return t.reduce((t,n)=>t+n.length,0)}function s(t,n){if(t[0].length===n)return t.shift();const o=new Uint8Array(n);let c=0;for(let i=0;i<n;i++)o[i]=t[0][c++],c===t[0].length&&(t.shift(),c=0);return t.length&&c<t[0].length&&(t[0]=t[0].slice(c)),o}e.decodePayload=(t,o)=>{const i=t.split(c),f=[];for(let t=0;t<i.length;t++){const c=(0,n.decodePacket)(i[t],o);if(f.push(c),\"error\"===c.type)break}return f};e.protocol=4});","lineCount":1,"map":[[1,106,87,7],[1,115,87,42,"maxPayload"],[1,117,87,54,"binaryType"],[1,120,88,9,"TEXT_DECODER"],[1,124,89,8,"TEXT_DECODER"],[1,126,89,23],[1,130,89,27,"TextDecoder"],[1,143,91,4],[1,149,91,10,"chunks"],[1,151,91,19],[1,154,92,4],[1,158,92,8,"state"],[1,160,92,16],[1,162,93,8,"expectedLength"],[1,165,93,22],[1,167,94,8,"isBinary"],[1,170,94,19],[1,172,95,4],[1,179,95,11],[1,183,95,15,"TransformStream"],[1,199,95,31],[1,200,96,8,"transform"],[1,210,96,18,"chunk"],[1,212,96,25,"controller"],[1,215,98,12],[1,219,97,12,"chunks"],[1,221,97,19,"push"],[1,226,97,24,"chunk"],[1,231,98,25],[1,232,99,16],[1,235,99,30],[1,239,99,20,"state"],[1,241,99,57],[1,242,100,20],[1,245,100,24,"totalLength"],[1,247,100,36,"chunks"],[1,250,100,46],[1,252,101,24],[1,258,103,20],[1,264,103,26,"header"],[1,266,103,35,"concatChunks"],[1,268,103,48,"chunks"],[1,270,103,56],[1,273,104,20,"isBinary"],[1,277,104,54],[1,282,104,32,"header"],[1,284,104,39],[1,288,105,20,"expectedLength"],[1,290,105,49],[1,294,105,37,"header"],[1,296,105,44],[1,299,107,24,"state"],[1,301,106,24,"expectedLength"],[1,303,106,41],[1,307,107,32],[1,309,109,48],[1,315,109,29,"expectedLength"],[1,317,110,32],[1,319,113,32],[1,320,115,16],[1,326,116,21],[1,329,116,35],[1,333,116,25,"state"],[1,335,116,74],[1,336,117,20],[1,339,117,24,"totalLength"],[1,341,117,36,"chunks"],[1,344,117,46],[1,346,118,24],[1,352,120,20],[1,358,120,26,"headerArray"],[1,360,120,40,"concatChunks"],[1,362,120,53,"chunks"],[1,364,120,61],[1,367,121,20,"expectedLength"],[1,369,121,37],[1,373,121,41,"DataView"],[1,382,121,50,"headerArray"],[1,384,121,62,"buffer"],[1,391,121,70,"headerArray"],[1,393,121,82,"byteOffset"],[1,404,121,94,"headerArray"],[1,406,121,106,"length"],[1,414,121,114,"getUint16"],[1,424,121,124],[1,427,122,20,"state"],[1,429,122,28],[1,430,123,16],[1,436,124,21],[1,439,124,35],[1,443,124,25,"state"],[1,445,124,74],[1,446,125,20],[1,449,125,24,"totalLength"],[1,451,125,36,"chunks"],[1,454,125,46],[1,456,126,24],[1,462,128,20],[1,468,128,26,"headerArray"],[1,470,128,40,"concatChunks"],[1,472,128,53,"chunks"],[1,474,128,61],[1,477,129,26,"view"],[1,479,129,33],[1,483,129,37,"DataView"],[1,492,129,46,"headerArray"],[1,494,129,58,"buffer"],[1,501,129,66,"headerArray"],[1,503,129,78,"byteOffset"],[1,514,129,90,"headerArray"],[1,516,129,102,"length"],[1,524,130,26,"n"],[1,526,130,30,"view"],[1,528,130,35,"getUint32"],[1,538,130,45],[1,541,131,20],[1,544,131,24,"n"],[1,546,131,28,"Math"],[1,551,131,33,"pow"],[1,555,131,37],[1,557,131,38],[1,561,131,51],[1,563,131,54],[1,564,133,24,"controller"],[1,566,133,35,"enqueue"],[1,574,133,43,"ERROR_PACKET"],[1,590,134,24],[1,595,135,20],[1,596,136,20,"expectedLength"],[1,598,136,37,"n"],[1,600,136,41,"Math"],[1,605,136,46,"pow"],[1,609,136,50],[1,611,136,53],[1,615,136,59,"view"],[1,617,136,64,"getUint32"],[1,627,136,74],[1,630,137,20,"state"],[1,632,137,28],[1,633,138,16],[1,638,139,21],[1,639,140,20],[1,642,140,24,"totalLength"],[1,644,140,36,"chunks"],[1,647,140,46,"expectedLength"],[1,649,141,24],[1,655,143,20],[1,661,143,26,"data"],[1,663,143,33,"concatChunks"],[1,665,143,46,"chunks"],[1,667,143,54,"expectedLength"],[1,670,144,20,"controller"],[1,672,144,31,"enqueue"],[1,681,144,39],[1,683,144,39,"decodePacket"],[1,699,144,52,"isBinary"],[1,701,144,63,"data"],[1,703,144,70,"TEXT_DECODER"],[1,705,144,83,"decode"],[1,712,144,90,"data"],[1,715,144,97,"binaryType"],[1,719,145,20,"state"],[1,721,145,28],[1,722,146,16],[1,723,147,16],[1,726,147,39],[1,730,147,20,"expectedLength"],[1,733,147,44,"expectedLength"],[1,735,147,61,"maxPayload"],[1,737,147,73],[1,738,148,20,"controller"],[1,740,148,31,"enqueue"],[1,748,148,39,"ERROR_PACKET"],[1,764,149,20],[1,769,150,16],[1,770,151,12],[1,771,152,8],[1,774,154,0],[1,776],[1,804,32,7],[1,815,33,4],[1,822,33,11],[1,826,33,15,"TransformStream"],[1,842,33,31],[1,843,34,8,"transform"],[1,853,34,18,"packet"],[1,855,34,26,"controller"],[1,859,35,12],[1,861,35,12,"encodePacketToBinary"],[1,885,35,33,"packet"],[1,887,35,42,"encodedPacket"],[1,891,36,16],[1,897,36,22,"payloadLength"],[1,899,36,38,"encodedPacket"],[1,901,36,52,"length"],[1,908,37,16],[1,912,37,20,"header"],[1,914,39,16],[1,917,39,20,"payloadLength"],[1,919,39,36],[1,923,40,20,"header"],[1,925,40,29],[1,929,40,33,"Uint8Array"],[1,940,40,44],[1,943,41,20],[1,947,41,24,"DataView"],[1,956,41,33,"header"],[1,958,41,40,"buffer"],[1,966,41,48,"setUint8"],[1,975,41,57],[1,977,41,60,"payloadLength"],[1,985,43,21],[1,988,43,25,"payloadLength"],[1,990,43,41],[1,996,43,48],[1,997,44,20,"header"],[1,999,44,29],[1,1003,44,33,"Uint8Array"],[1,1014,44,44],[1,1017,45,20],[1,1023,45,26,"view"],[1,1025,45,33],[1,1029,45,37,"DataView"],[1,1038,45,46,"header"],[1,1040,45,53,"buffer"],[1,1048,46,20,"view"],[1,1050,46,25,"setUint8"],[1,1059,46,34],[1,1061,46,37],[1,1066,47,20,"view"],[1,1068,47,25,"setUint16"],[1,1078,47,35],[1,1080,47,38,"payloadLength"],[1,1082,48,16],[1,1087,49,21],[1,1088,50,20,"header"],[1,1090,50,29],[1,1094,50,33,"Uint8Array"],[1,1105,50,44],[1,1108,51,20],[1,1114,51,26,"view"],[1,1116,51,33],[1,1120,51,37,"DataView"],[1,1129,51,46,"header"],[1,1131,51,53,"buffer"],[1,1139,52,20,"view"],[1,1141,52,25,"setUint8"],[1,1150,52,34],[1,1152,52,37],[1,1157,53,20,"view"],[1,1159,53,25,"setBigUint64"],[1,1172,53,38],[1,1174,53,41,"BigInt"],[1,1181,53,48,"payloadLength"],[1,1184,54,16],[1,1185,56,20,"packet"],[1,1187,56,27,"data"],[1,1193,56,58],[1,1210,56,42,"packet"],[1,1212,56,49,"data"],[1,1219,57,20,"header"],[1,1221,57,27],[1,1225,57,33],[1,1230,59,16,"controller"],[1,1232,59,27,"enqueue"],[1,1240,59,35,"header"],[1,1243,60,16,"controller"],[1,1245,60,27,"enqueue"],[1,1253,60,35,"encodedPacket"],[1,1257,62,8],[1,1260,64,0],[1,1262],[1,1507,1,0],[1,1511,1,0,"_encodePacket"],[1,1513,1,0,"r"],[1,1515,1,0,"d"],[1,1517,1,0],[1,1521,2,0,"_decodePacket"],[1,1523,2,0,"r"],[1,1525,2,0,"d"],[1,1527,2,0],[1,1531,3,0,"_commons"],[1,1533,3,0,"r"],[1,1535,3,0,"d"],[1,1537,3,0],[1,1541,4,0],[1,1547,4,6,"SEPARATOR"],[1,1549,4,18,"String"],[1,1556,4,25,"fromCharCode"],[1,1569,4,38],[1,1573,19,2,"e"],[1,1575,19,2,"encodePayload"],[1,1589,5,22,"encodePayload"],[1,1590,5,23,"packets"],[1,1592,5,32,"callback"],[1,1597,7,4],[1,1603,7,10,"length"],[1,1605,7,19,"packets"],[1,1607,7,27,"length"],[1,1614,8,10,"encodedPackets"],[1,1616,8,27],[1,1620,8,31,"Array"],[1,1626,8,37,"length"],[1,1629,9,4],[1,1633,9,8,"count"],[1,1635,9,16],[1,1637,10,4,"packets"],[1,1639,10,12,"forEach"],[1,1647,10,20],[1,1648,10,21,"packet"],[1,1650,10,29,"i"],[1,1656,12,8],[1,1658,12,8,"encodePacket"],[1,1674,12,21,"packet"],[1,1677,12,29],[1,1679,12,37,"encodedPacket"],[1,1683,13,12,"encodedPackets"],[1,1685,13,27,"i"],[1,1688,13,32,"encodedPacket"],[1,1692,14,18,"count"],[1,1696,14,28,"length"],[1,1699,15,16,"callback"],[1,1701,15,25,"encodedPackets"],[1,1703,15,40,"join"],[1,1708,15,45,"SEPARATOR"],[1,1717,65,0],[1,1721,65,4,"TEXT_DECODER"],[1,1723,66,0],[1,1732,66,9,"totalLength"],[1,1734,66,21,"chunks"],[1,1737,67,4],[1,1744,67,11,"chunks"],[1,1746,67,18,"reduce"],[1,1753,67,25],[1,1754,67,26,"acc"],[1,1756,67,31,"chunk"],[1,1760,67,41,"acc"],[1,1762,67,47,"chunk"],[1,1764,67,53,"length"],[1,1771,67,61],[1,1773,68,0],[1,1774,69,0],[1,1783,69,9,"concatChunks"],[1,1785,69,22,"chunks"],[1,1787,69,30,"size"],[1,1790,70,4],[1,1793,70,8,"chunks"],[1,1795,70,15],[1,1798,70,18,"length"],[1,1807,70,29,"size"],[1,1809,71,8],[1,1816,71,15,"chunks"],[1,1818,71,22,"shift"],[1,1826,73,4],[1,1832,73,10,"buffer"],[1,1834,73,19],[1,1838,73,23,"Uint8Array"],[1,1849,73,34,"size"],[1,1852,74,4],[1,1856,74,8,"j"],[1,1858,74,12],[1,1860,75,4],[1,1864,75,9],[1,1868,75,13,"i"],[1,1870,75,17],[1,1872,75,20,"i"],[1,1874,75,24,"size"],[1,1876,75,30,"i"],[1,1880,76,8,"buffer"],[1,1882,76,15,"i"],[1,1885,76,20,"chunks"],[1,1887,76,27],[1,1890,76,30,"j"],[1,1895,77,12,"j"],[1,1899,77,18,"chunks"],[1,1901,77,25],[1,1904,77,28,"length"],[1,1913,78,12,"chunks"],[1,1915,78,19,"shift"],[1,1923,79,12,"j"],[1,1925,79,16],[1,1928,85,4],[1,1935,82,8,"chunks"],[1,1937,82,15,"length"],[1,1945,82,25,"j"],[1,1947,82,29,"chunks"],[1,1949,82,36],[1,1952,82,39,"length"],[1,1961,83,8,"chunks"],[1,1963,83,15],[1,1966,83,20,"chunks"],[1,1968,83,27],[1,1971,83,30,"slice"],[1,1977,83,36,"j"],[1,1981,85,11,"buffer"],[1,1982,86,0],[1,1983,31,2,"e"],[1,1985,31,2,"decodePayload"],[1,1999,20,22,"decodePayload"],[1,2000,20,23,"encodedPayload"],[1,2002,20,39,"binaryType"],[1,2007,21,4],[1,2013,21,10,"encodedPackets"],[1,2015,21,27,"encodedPayload"],[1,2017,21,42,"split"],[1,2023,21,48,"SEPARATOR"],[1,2026,22,10,"packets"],[1,2028,22,20],[1,2031,23,4],[1,2035,23,9],[1,2039,23,13,"i"],[1,2041,23,17],[1,2043,23,20,"i"],[1,2045,23,24,"encodedPackets"],[1,2047,23,39,"length"],[1,2054,23,47,"i"],[1,2058,23,52],[1,2059,24,8],[1,2065,24,14,"decodedPacket"],[1,2068,24,30],[1,2070,24,30,"decodePacket"],[1,2086,24,43,"encodedPackets"],[1,2088,24,58,"i"],[1,2091,24,62,"binaryType"],[1,2094,26,8],[1,2097,25,8,"packets"],[1,2099,25,16,"push"],[1,2104,25,21,"decodedPacket"],[1,2107,26,35],[1,2117,26,12,"decodedPacket"],[1,2119,26,26,"type"],[1,2124,27,12],[1,2129,29,4],[1,2130,30,4],[1,2137,30,11,"packets"],[1,2140,155,21,"e"],[1,2142,155,21,"protocol"],[1,2151,155,24],[1,2152,155,26],[1,2155]],"functionMap":{"names":["<global>","encodePayload","packets.forEach$argument_0","encodePacket$argument_2","decodePayload","createPacketEncoderStream","TransformStream$argument_0.transform","encodePacketToBinary$argument_1","totalLength","chunks.reduce$argument_0","concatChunks","createPacketDecoderStream"],"mappings":"AAA;sBCI;oBCK;oCCE;SDK;KDC;CDC;sBIC;CJW;OKC;QCE;yCCC;aD0B;SDC;CLE;AQE;yBCC,kCD;CRC;AUC;CViB;OWC;QLS;SKwD;CXE"}},"type":"js/module"}]}